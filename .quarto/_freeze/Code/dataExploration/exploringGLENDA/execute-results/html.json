{
  "hash": "9aa1fbed08516529821b104a64bba0f2",
  "result": {
    "markdown": "---\ntitle: \"Exploring Full WQD\"\nmetadata-files:\n  - \"../../_quarto.yml\"\n---\n\n\nI split the NA types into three categories (for sure NA's, Unsure NA or not, Definitely not NA's but I'll address later). You can see with the line break in na argument. I determined missing values in each \"VALUE\" column with the commented out code below Dropped ANAL_CODE\\_ columns because they are redundant with the \"Analyte\" columns\n\n\n\n\n\n# Spatial summary\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Density of samples with respect to latitude and longitude](exploringGLENDA_files/figure-html/samplesSpace-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/depths-1.png){width=672}\n:::\n:::\n\n\n## Time summary\n\n\n::: {.cell tbl-cap='Range of years of sampling for each analyte colored by the proportion of zeros that were observed'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/sampleYears-1.png){width=672}\n:::\n:::\n\n\n## Season summary\n\n\n::: {.cell tbl-cap='Range of  months of sampling for each analyte colored by the proportion of zeros that were observed'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/sampleSeason-1.png){width=672}\n:::\n:::\n\n\n## Time of Day\n\n\n::: {.cell tbl-cap='Range of  months of sampling for each analyte colored by the proportion of zeros that were observed'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/sampleTime-1.png){width=672}\n:::\n:::\n\n\n# Sampling Fraction\n\n\n::: {.cell tbl-cap='Number of observations from each type of sampling fraction'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/samplingFractions-1.png){width=672}\n:::\n:::\n\n\n# Depth Codes\n\n\n::: {.cell tbl-cap='Number of observations from each  Depth (represented by color)'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/depthCodes-1.png){width=672}\n:::\n:::\n\n\n# Units\n\nOnly measure with multiple units is Turbidty (FTU/NTU), they seem to follow same distribution\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/findingMultipleUnits-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ANALYTE </th>\n   <th style=\"text-align:left;\"> UNITS </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Alkalinity, Total as CaCO3 </td>\n   <td style=\"text-align:left;\"> mg/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Alkalinity, Total as CaCO3 </td>\n   <td style=\"text-align:left;\"> none </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Carbon, Organic </td>\n   <td style=\"text-align:left;\"> % </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Carbon, Organic </td>\n   <td style=\"text-align:left;\"> mg/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Carbon, Organic </td>\n   <td style=\"text-align:left;\"> mg/g </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Conductivity </td>\n   <td style=\"text-align:left;\"> umho/cm </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Conductivity </td>\n   <td style=\"text-align:left;\"> none </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Magnesium </td>\n   <td style=\"text-align:left;\"> mg/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Magnesium </td>\n   <td style=\"text-align:left;\"> ug/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Manganese </td>\n   <td style=\"text-align:left;\"> ug/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Manganese </td>\n   <td style=\"text-align:left;\"> none </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Phosphorus, Orthophosphorus as P </td>\n   <td style=\"text-align:left;\"> ug/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Phosphorus, Orthophosphorus as P </td>\n   <td style=\"text-align:left;\"> mg/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Secchi Disc Transparency </td>\n   <td style=\"text-align:left;\"> m </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Secchi Disc Transparency </td>\n   <td style=\"text-align:left;\"> none </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sodium </td>\n   <td style=\"text-align:left;\"> mg/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sodium </td>\n   <td style=\"text-align:left;\"> ug/l </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Turbidity </td>\n   <td style=\"text-align:left;\"> NTU </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Turbidity </td>\n   <td style=\"text-align:left;\"> none </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Turbidity </td>\n   <td style=\"text-align:left;\"> FTU </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n# Remarks\n\n\n::: {.cell tbl-cap='Counts for each type of remarks'}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/remarks-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/remarks-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 25\n# ℹ 25 variables: YEAR <int>, MONTH <chr>, SEASON <chr>, LAKE <chr>,\n#   CRUISE_ID <chr>, VISIT_ID <chr>, STATION_ID <chr>, STN_DEPTH_M <dbl>,\n#   LATITUDE <dbl>, LONGITUDE <dbl>, SAMPLING_DATE <date>, TIME_ZONE <chr>,\n#   SAMPLE_DEPTH_M <dbl>, DEPTH_CODE <chr>, MEDIUM <chr>, SAMPLE_TYPE <chr>,\n#   QC_TYPE <chr>, SAMPLE_ID <chr>, ANALYTE <chr>, VALUE <dbl>, UNITS <chr>,\n#   FRACTION <chr>, METHOD <chr>, RESULT_REMARK <chr>, REMARK_RISK <chr>\n```\n:::\n:::\n\n\n# Flag risks\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> REMARK_RISK </th>\n   <th style=\"text-align:left;\"> CLASS </th>\n   <th style=\"text-align:left;\"> RESULT_REMARK </th>\n   <th style=\"text-align:left;\"> DESCRIPTION </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> HIGH </td>\n   <td style=\"text-align:left;\"> QC Failed </td>\n   <td style=\"text-align:left;\"> Field Duplicate, failed </td>\n   <td style=\"text-align:left;\"> A field duplicate associated with this analysis failed the acceptance criteria. Validity of reported value may be compromised </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HIGH </td>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:left;\"> Field Lab Anomaly </td>\n   <td style=\"text-align:left;\"> Reported value for lab measurement was inconsistent with reported value for corresponding field measurement. Validity of reported value may be compromised </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HIGH </td>\n   <td style=\"text-align:left;\"> No Result Reported </td>\n   <td style=\"text-align:left;\"> No Result Reported, analysis canceled </td>\n   <td style=\"text-align:left;\"> Analysis was canceled and not performed. No result value was reported </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HIGH </td>\n   <td style=\"text-align:left;\"> Contamination </td>\n   <td style=\"text-align:left;\"> Suspected Contamination, field </td>\n   <td style=\"text-align:left;\"> Contamination is suspected to have occurred during the field collection process. Validity of reported value may be compromised </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HIGH </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Lab Duplicate, failed;Invalid </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MEDIUM </td>\n   <td style=\"text-align:left;\"> QC Incomplete </td>\n   <td style=\"text-align:left;\"> Quality Control incomplete </td>\n   <td style=\"text-align:left;\"> Some quality control samples (such as duplicates or standard checks) related to the analysis were not prepared, analyzed, or reported. </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MEDIUM </td>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:left;\"> Outlier, accross stations </td>\n   <td style=\"text-align:left;\"> Reported value was determined to be an outlier (&gt; 3 std. devs) when compared to other data values from the same project accross all station at which field samples were collected. </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MEDIUM </td>\n   <td style=\"text-align:left;\"> Handling </td>\n   <td style=\"text-align:left;\"> Exceeded Holding Time </td>\n   <td style=\"text-align:left;\"> Sample or extract was held longer than the approved amount of time before analysis. Validity of reported value may be compromised </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MEDIUM </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Quality Control incomplete;Suspected Contamination, field </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LOW </td>\n   <td style=\"text-align:left;\"> Limit </td>\n   <td style=\"text-align:left;\"> Method Detection Limit, less than </td>\n   <td style=\"text-align:left;\"> Analyte produced an instrument response but reported value is below the calculated method detection limit. Validity of reported value may be compromised </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LOW </td>\n   <td style=\"text-align:left;\"> Estimated Value </td>\n   <td style=\"text-align:left;\"> Estimated Value, outside limit of precision </td>\n   <td style=\"text-align:left;\"> Reported value was not within expected limits of precision and is therefore considered an estimate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LOW </td>\n   <td style=\"text-align:left;\"> Corrected </td>\n   <td style=\"text-align:left;\"> Correction Factor, lab </td>\n   <td style=\"text-align:left;\"> Reported value was corrected by a lab performance check factor </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LOW </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Method Detection Limit, less than;Exceeded Holding Time </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n# Missingness\n\n## Analytes\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/MissingnessChloro-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/MissingnessChloro-2.png){width=672}\n:::\n:::\n\n\n## Spatial information\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/missingCoords-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](exploringGLENDA_files/figure-html/missingCoords-2.png){width=672}\n:::\n:::\n\n\n<!-- # Modeling information -->\n\n<!-- ## Marginal correlations of selected covariates -->\n\n<!-- ```{r ggpairs} -->\n<!-- #| warning: false -->\n<!-- #| fig-caption: \"Pairwise correlation for selected variables\" -->\n<!-- #| cache: true -->\n\n<!-- # lModel <- lm(formula = `Chlorophyll-a` ~ .- SAMPLE_ID, data= dfWide) -->\n\n<!-- ggpairs(dfWide, columns = 2:10, progress = F) -->\n\n\n\n<!-- ``` -->\n\n<!-- ## RF Model -->\n\n<!-- ```{r splittingData} -->\n<!-- set.seed(222) -->\n<!-- dfWide <- janitor::clean_names(dfWide) -->\n<!-- ind <- sample(2, nrow(dfWide), replace = TRUE, prob = c(0.7, 0.3)) -->\n<!-- train <- dfWide[ind==1,] -->\n<!-- test <- dfWide[ind==2,] -->\n<!-- ``` -->\n\n<!-- ```{r randomForest} -->\n<!-- #| cache: true -->\n<!-- #| tbl-cap: \"Prediction results on hold out data\" -->\n<!-- rf <- randomForest::randomForest(chlorophyll_a ~. - sample_id, data=train, proximity=TRUE, na.action = na.omit)  -->\n<!-- print(rf) -->\n<!-- p <- predict(rf, newdata = test) -->\n<!-- caret::postResample(p, test$chlorophyll_a) %>% -->\n<!--   as.data.frame() %>% -->\n<!--   kable() %>% -->\n<!--   kable_paper() -->\n<!-- ``` -->\n\n<!-- ## Distributions of selected covariates -->\n\n<!-- ```{r covarDists} -->\n<!-- g <- dfWide %>% -->\n<!--   pivot_longer(-c(sample_id, year, season)) %>% -->\n<!--   ggplot(aes(x = value)) + -->\n<!--   geom_histogram() + -->\n<!--   facet_wrap(~name, scales = \"free\") +  -->\n<!--   ggtitle(\"linear scale\") -->\n<!-- g -->\n<!-- g+ scale_x_log10() +ggtitle(\"log10 scale\") -->\n<!-- ``` -->\n\n<!-- ```{r spaghetti} -->\n<!-- df %>% -->\n<!--   filter(ANALYTE == \"Chlorophyll-a\", DEPTH_CODE == \"Surface\") %>% -->\n<!--   unite(\"Position\", LATITUDE, LONGITUDE) %>% -->\n<!--   mutate(SAMPLING_DATE = date(SAMPLING_DATE)) %>% -->\n<!--   group_by(SAMPLING_DATE, Position) %>% -->\n<!--   summarize(CHLA = mean(VALUE, rm.na=  T)) %>% -->\n<!--   ggplot(aes(x = SAMPLING_DATE, y = CHLA, col = factor(Position))) + -->\n<!--   geom_line() + -->\n<!--   theme(legend.position = \"none\") + -->\n<!--   ggtitle(\"Spaghetti plot of CHLA over time for each LAT/LONG, Surface samples\") -->\n\n<!-- ``` -->\n\n<!-- # Dealing with similar/same analytes -->\n\n<!-- | Similar Analytes                                 | How to resovlve | Reason                        | -->\n<!-- |:--------------------------|:---------------------------|:----------------| -->\n<!-- | Ammonia-Nitrogen / Ammonium-Nitrogen             |                 |                               | -->\n<!-- | Alkalinity / Hardness                            | Drop Hardness   | Hardness has 95% missingness  | -->\n<!-- | Nitrogen particulate / Nitrogen sediment         |                 |                               | -->\n<!-- | Turbidity / Secchi disc / total suspended solids | Keep Turbidity  | Others have \\>90% missingness | -->\n\n<!-- | Phosphorus, Base Extractable as P\" ? ???? -->\n\n<!-- -   Phosphorus Total as P -->\n<!-- -   Phsophorus particulate/ sediment -->\n\n<!-- <!-- ```{r vizMissing} --> -->\n<!-- <!-- dfWide %>% --> -->\n<!-- <!--   select(contains(\"Hardness\"), contains(\"Alkalinity\")) %>% --> -->\n<!-- <!--   visdat::vis_miss() --> -->\n\n<!-- <!-- dfWide %>% --> -->\n<!-- <!--   select(contains(\"Turbid\"), contains(\"Secchi\"), contains(\"suspended\")) %>% --> -->\n<!-- <!--   visdat::vis_miss() --> -->\n\n\n<!-- <!-- ``` --> -->\n\n<!-- <!-- # PCA --> -->\n\n<!-- <!-- ```{r PCA} --> -->\n<!-- <!-- dfWideNoMiss <- dfWide %>% --> -->\n<!-- <!--   janitor::clean_names() %>% --> -->\n<!-- <!--   mutate(lchla = log(chlorophyll_a + 0.01)) %>% --> -->\n<!-- <!--   drop_na() --> -->\n<!-- <!-- PCA <- dfWideNoMiss %>%  --> -->\n<!-- <!--   select(-c(sample_id, season, year, chlorophyll_a, lchla))  %>% --> -->\n<!-- <!--   prcomp(center = T, scale=T) --> -->\n\n<!-- <!-- plot(summary(PCA)$importance[2,], xlab= \"Principal component\", ylab = \"% variance explained\") --> -->\n\n<!-- <!-- autoplot(PCA, data = dfWideNoMiss, colour = \"lchla\", --> -->\n<!-- <!--          loadings = TRUE, loadings.colour = 'blue', --> -->\n<!-- <!--          loadings.label = TRUE, loadings.label.size = 3) --> -->\n<!-- <!-- autoplot(PCA, data = dfWideNoMiss, colour = \"season\", --> -->\n<!-- <!--          loadings = TRUE, loadings.colour = 'blue', --> -->\n<!-- <!--          loadings.label = TRUE, loadings.label.size = 3) --> -->\n<!-- <!-- autoplot(clara(dfWideNoMiss[-c(1,2,3,13)], 2)) --> -->\n<!-- <!-- ``` --> -->\n",
    "supporting": [
      "exploringGLENDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"exploringGLENDA_files/libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"exploringGLENDA_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}